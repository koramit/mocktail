<template>
    <Head title="Mocktail: ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô" />
    <div class="flex flex-col justify-center items-center w-full min-h-screen">
        <div
            class="flex flex-col justify-center items-center w-28 h-28 rounded-full border-soft-theme-light border-4 font-semibold bg-dark-theme-light z-10"
        >
            <div class=" text-white text-3xl">
                SiMED
            </div>
            <div class=" text-soft-theme-light text-xl italic">
                Mocktail
            </div>
        </div>
        <div class="mt-4 px-4 py-8 w-80 bg-white rounded shadow transform -translate-y-20">
            <!--  üßô‚Äç‚ôÄÔ∏è üßô‚Äç‚ôÇÔ∏è-->
            <span class="block font-semibold text-xl text-thick-theme-light mt-12 text-center">üë©‚Äçüöí Ad hoc Ward üßë‚Äçüöí</span>
            <form-input
                class="mt-4"
                label="‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ"
                name="login"
                v-model="form.login"
                :error="form.errors.login"
            />
            <form-input
                class="mt-2"
                type="password"
                label="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô"
                name="password"
                v-model="form.password"
                :error="form.errors.password"
                @keydown.enter="login"
            />
            <spinner-button
                :spin="form.processing"
                class="btn-dark w-full my-6"
                @click="login"
            >
                ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
            </spinner-button>
            <!-- <a
                :href="`${$page.props.app.baseUrl}/login/line`"
                class="flex justify-center items-center mt-8 cursor-pointer w-full rounded-sm shadow-sm bg-line text-center text-gray-100 p-2"
            >
                <icon
                    name="line-app"
                    class="w-6 h-6 mr-2"
                />Log in with LINE
            </a> -->
            <Link
                :href="`${baseUrl}/register`"
                class="text-bitter-theme-light"
            >
                ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏´‡∏°‡πà
            </Link>
            <!-- annoucement -->
            <div class="mt-4 rounded-lg shadow p-4 bg-thick-theme-light text-white font-semibold">
                <p>‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</p>
                <!-- ‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏î‡∏±‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ -->
                <p class="mt-2 italic text-xs">
                    ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ó‡πà‡∏≤‡∏ô‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏ö‡∏≤‡∏á‡∏Ç‡∏ì‡∏∞ ‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å üôèüôèüôè
                </p>
                <p class="mt-2 text-xs">
                    ‡πè ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏î‡πâ‡∏ß‡∏¢‡∏®‡∏¥‡∏£‡∏¥‡∏£‡∏≤‡∏ä AD ‡∏ô‡∏≤‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏£‡∏Å‡∏ï‡∏¥
                </p>
                <p class="mt-2 text-xs">
                    ‡πè ‡∏£‡∏±‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ó‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ ‡∏ô‡∏≤‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏£‡∏Å‡∏ï‡∏¥
                </p>
                <p class="mt-2 text-xs">
                    ‡πè ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Discharge Summary ‡∏ô‡∏≤‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏£‡∏Å‡∏ï‡∏¥
                </p>
                <!-- <p class="mt-2 text-xs">
                    ‡πè ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏î‡πâ‡∏ß‡∏¢‡∏®‡∏¥‡∏£‡∏¥‡∏£‡∏≤‡∏ä AD
                </p>
                <p class="mt-2 text-xs">
                    ‡πè ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏à‡∏≤‡∏Å HN
                </p>
                <p class="mt-2 text-xs">
                    ‡πè ‡∏£‡∏±‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ó‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
                </p>
                <p class="mt-2 text-xs">
                    ‡∏≠‡∏±‡∏ô‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ ‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å
                </p> -->
            </div>
        </div>
    </div>
</template>

<script>
import { useForm } from '@inertiajs/inertia-vue3';
import FormInput from '@/Components/Controls/FormInput';
import SpinnerButton from '@/Components/Controls/SpinnerButton';
import { Head, Link } from '@inertiajs/inertia-vue3';
export default {
    components: { FormInput, SpinnerButton, Head, Link },
    data () {
        return {
            form: useForm({
                login: null,
                password: null,
                remember: true
            }),
            baseUrl: this.$page.props.app.baseUrl,
        };
    },
    created () {
        // document.title = 'Mocktail: ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';

        this.baseUrl = document.querySelector('meta[name=base-url]').content;
        var lastTimeCheckSessionTimeout = Date.now();
        const endpoint =  this.baseUrl + '/session-timeout';
        const sessionLifetimeSeconds = parseInt(document.querySelector('meta[name=session-lifetime-seconds]').content);
        window.addEventListener('focus', () => {
            let timeDiff = Date.now() - lastTimeCheckSessionTimeout;
            if ( (timeDiff) > (sessionLifetimeSeconds) ) {
                window.axios
                    .post(endpoint)
                    .then(() => lastTimeCheckSessionTimeout = Date.now())
                    .catch(() => location.reload());
            }
        });
    },
    mounted() {
        this.$nextTick(function () {
            const pageLoadingIndicator = document.getElementById('page-loading-indicator');
            if (pageLoadingIndicator) {
                pageLoadingIndicator.remove();
            }
        });
    },
    methods: {
        login () {
            this.form
                .transform(data => ({
                    ...data,
                    remember: data.remember ? 'on' : '',
                }))
                .post(`${this.baseUrl}/login`, {
                    replace: true,
                    onFinish: () => this.form.processing = false,
                });
        }
    }
};
</script>

<style scoped>
    .bg-line {
        background-color: #00b900;
    }
    .bg-telegram {
        background-color: #54a9eb;
    }
</style>